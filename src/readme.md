#暗网空间使用和开发指南 <center>![](http://darknetspace.org/files/ico.png)</center>V1.1 (0.6.8.3)2015年1月4日DarkNetSpace开发团队http://darknetspace.org  ##目　录[TOC] #暗网空间使用和开发指南V1.0暗网空间(DarkNetSpace)是一个以强匿名为主题的二代币应用系统。在强匿名技术基础上提供P2P兑换所、块链商城（可能会实现资产管理、彩票、博彩、赌约、担保、抵押、期货）等应用。暗网币（DarkNetCoin）是其中的基准货币。项目目标：暗网空间成为最隐私、最匿名的加密货币应用平台；暗网币成为最隐私、最匿名的通用货币。暗网空间由几个程序组成，图形化界面`qt-dnsp`、主程序`dnsd`、钱包`simplewallet`、连接工具`connectivity_tool`，其中图形化钱包`qt-dnsp`是主程序、钱包、连接工具等几个程序的集合，即：`qt-dnsp` ＝ `dnsd` + `simplewallet` + `connectivity_tool`。以下对这些程序的使用和开发进行一一说明。##1. 图形化界面qt-dnsp使用指南1. 首先将下载的钱包解压（可以指定目录），注意：钱包软件的目录不要包含有中文。2. 双击qt-dnsp.exe打开钱包，等待下载完钱包数据后点击Wallet。	![](http://darknetspace.org/files/manual01.png) 3. 新建钱包：从”Connectivity”选项切换到”Wallet”选项，然后点击Generate new wallet新建一个钱包。默认是会把钱包文件保存在当前文件夹下，可以自己调整保存的位置。修改 文件名后点击保存。（中文会出现乱码）	![](http://darknetspace.org/files/manual02.png) 5. 输入密码，这个密码是以后登录的唯一凭证，忘记后无法找回。注意：一定要牢记密码！	![](http://darknetspace.org/files/manual03.png) 6. 钱包文件解释：`.dnc`是数据文件，`.address.txt`保存了地址，`.keys`是比较关键的文件，注意不要丢失。 	![](http://darknetspace.org/files/manual07.png)7. 打开钱包：点击Open wallet打开钱包，选定上面.dnc或者.keys文件中的任一文件后，输入密码都可以打开钱包。	![](http://darknetspace.org/files/manual04.png)	 8. 钱包界面解释：Balance: 拥有的币数 Unlocked: 可以使用的币数。Send payment可以给其他地址发币。Recent transfers 近期的交易记录。9. 转账：在Send payment的Address中输入想要转账的地址，在Amount中输入币数，点击Send即可转账；也可以选择”More options”来输入更多参数	![](http://darknetspace.org/files/manual05.png) ##2. 主程序dnsd使用及开发指南   `dnsd`是块链更新程序，`simplewallet`要依赖于`dnsd`运行。`dnsd`的运行很简单，直接运行`dnsd`即可：   	./dnsd###2.1. 控制台命令|命令|命令说明|命令举例||---|------|------||get_transactions_statics|交易统计|get_transactions_statics||help|帮助|help||hide_hr|隐藏打印|hide_hr||make_alias|提出的别名的预订记录成块模板，如果别名是免费的|||print_bc|打印指定范围内的区块信息|print_bc <begin_height> [<end_height>]||print_block|打印区块信息	|print_block <block_hash> \| <block_height>||print_cn|显示节点||	|print_pl|打印连接ip||	|print_pool|显示矿池信息（长格式）|||print_pool_sh|显示矿池信息（短格式）||	|print_tx|打印交易|print_tx <transaction_hash>||save|保存|save||start_mining|开始挖矿|start_mining <addr> [threads=1]||stop_mining|停止挖矿|stop_mining||show_hr|显示挖矿速度|show_hr|  ###2.2 RPC接口`dnsd`的RPC接口有两类，包括JSON接口和BIN接口。JSON接口是以JSON格式进行通讯的接口，一般用于实时性要求不高的远程通讯上。而BIN接口则是以二进制数据结构进行通讯的接口，一般用于实时性要求高的本地通讯和远程通讯。####2.2.1 JSON	JSON接口一般通过`http://127.0.0.1:37709/`来访问各种接口，后跟接口命令名。我们可以通过`curl -X POST http://127.0.0.1:37709/getheight`这样的命令来测试，如果不带参数，可以直接通过浏览器来输入从而获得输出。**注意点：以下是用curl在LINUX下的演示，如果在WINDOWS上使用，则把数据串引号`”`替换成`\"`。**#####2.2.1.1获得区块数量getheightRPC命令：http://127.0.0.1:37709/getheight输入数据：无输出结果：    {        "height": 73137,        "status": "OK"    }#####2.2.1.2获得指定的交易列表gettransactionsRPC命令：http://127.0.0.1:37709/gettransactions输入数据：    {        "txs_hashes":["97cccff36cd11c4b8f4dc0dc81fb2442662c4f2c9cafa49f1580609c474e59c"]    }输出结果： 	    {         "status": "OK",	        "txs_as_hex": [],        "missed_tx":[]    }其中`txs_as_hex`是找到的交易列表，格式为以字符串表示的十六进制交易内容。`missed_tx`是未找到的交易ID列表。`status`返回值不是`OK`的表示出现错误，有错误提示。#####2.2.1.3获得指定的交易get_transactions本接口与上一接口的gettransactions功能类似，不同点是返回交易是JSON格式。RPC命令：http://127.0.0.1:37709/get_transactions  输入数据：    {        "txs_hashes": [            "97cccff36cd11c4b8f4dc0dc81fb2442662c4f2c9cafa49f1580609c474e59c",            "0399f25da8ae73fff4b2ddd93463d189968e3059b8dc65b8967306b781c3fcda"        ]    }输出结果：     {          "status": "OK",         "txs_as_hex": [],         "missed_tx":[]     }其中`txs_as_hex`是找到的交易列表，格式为以JSON格式的交易内容。每个交易的JSON格式如下所示：	{	    "version": 1,	    "unlock_time": 80061,	    "vin": [	        {	            "gen": {	                "height": 80001	            }	        }	    ],	    "vout": [	        {	            "amount": 400000,	            "target": {	                "key": "63c707badaf0151912408d812098c8b8f42a937532f20060b014ccb5a98d9f0500"	            }	        },	        {	            "amount": 6000000,	            "target": {	                "key": "16eea8ffd98d418e24a78a8ac94020465467b162023a0777d4a76260f9f30b1700"	            }	        },	        {	            "amount": 70000000,	            "target": {	                "key": "60060bf166f6279ecf11e12ed490120f8890b0e5827bfaf9ccee0fc4a06b8e9600"	            }	        },	        {	            "amount": 900000000,	            "target": {	                "key": "8fd00058af39451e82ed4e4e5d516878ab49ab178b747c3fd92d94f9041dd9bd00"	            }	        },	        {	            "amount": 7000000000,	            "target": {	                "key": "8626ce6ec6003e27e675934e81612db577e47c7346b750ae0d4022bc3dfb51a200"	            }	        },	        {	            "amount": 90000000000,	            "target": {	                "key": "a1dfac9db983dbf5b08da1fd69935d04fc64116735e9956b81cea2684972c94a00"	            }	        },	        {	            "amount": 700000000000,	            "target": {	                "key": "e8278e157293077d560821affd29eefcaf9f7b40d7ae58a38dde4c8e26c5b95e00"	            }	        },	        {	            "amount": 8000000000000,	            "target": {	                "key": "5b8097a74b3e72e9fa18a8a2724b68b035e97f4afcb50cfdcf0db4acb8daad3b00"	            }	        },	        {	            "amount": 60000000000000,	            "target": {	                "key": "61397e6cb9b482341998c680428008b88b3cfd95a3dce0b9884865e23519825a00"	            }	        },	        {	            "amount": 6879797640000,	            "target": {	                "key": "e1950b810f6c2da80d96e80975ce8990816137dbde08a6f375006d862c6a56ec00"	            }	        },	        {	            "amount": 764421960000,	            "target": {	                "key": "81af4b7cae885d4ae1199b1002a4ffb9239c67ec64c9df07d453230bd4d0b17e00"	            }	        }	    ],	    "extra": [	        1,	        106,	        220,	        188,	        71,	        105,	        187,	        236,	        197,	        132,	        195,	        67,	        253,	        223,	        5,	        0,	        30,	        174,	        253,	        34,	        45,	        246,	        170,	        235,	        38,	        40,	        111,	        21,	        136,	        15,	        78,	        111,	        9,	        2,	        30,	        48,	        46,	        54,	        46,	        54,	        46,	        49,	        40,	        48,	        46,	        49,	        45,	        103,	        52,	        48,	        98,	        56,	        57,	        102,	        48,	        41,	        0,	        0,	        0,	        6,	        79,	        169,	        114,	        25,	        0	    ],	    "signatures": [],	    "tx_hashes": []	}	`missed_tx`是未找到的交易ID列表。`status`返回值不是`OK`的表示出现错误，有错误提示。#####2.2.1.4获得内存池交易列表get_tx_poolRPC命令：http://127.0.0.1:37709/get_tx_pool输入数据：无输出结果：    {        "status": "OK",        "txs": []    }`txs`是JSON格式表示的交易内容，格式同2.2.1.3节的交易JSON格式。`status`返回值不是`OK`的表示出现错误，有错误提示。#####2.2.1.5获得区块列表get_blocks_by_heightsRPC命令：http://127.0.0.1:37709/get_blocks_by_heights  输入数据：    {        "start_height": 80000,        "blocks_count": 3,        "genesis_hash": "aecf5933feeaf47857d096f82d97de644a25dfa63c47c0118c349d4385400f80"    }其中：start_height: 开始区块blocks_count: 要下载的区块数，不超过100块genesis_hash: 创世区块的HASH输出结果：    {        "status": "OK",        "blocks_count": 0,        "blocks": [            {                "block": "",                "txs": []            },            {                "block": "",                "txs": []            }        ]    }其中`blocks_count`是返回的区块数。`blocks`是区块内容列表，返回区块头、挖矿交易和其他交易。`blocks`中可能没有`txs`。`block`的数据JSON格式如下所示：    {	    "major_version": 1,	    "nonce": 2185365362,	    "prev_id": "d3855e2a339fdf5934e20d5dd397b1a271537e98bd8ae6e144b419dd2da22519",	    "minor_version": 0,	    "timestamp": 1417934844,	    "flags": 0,	    "miner_tx": {	        "version": 1,	        "unlock_time": 80061,	        "vin": [	            {	                "gen": {	                    "height": 80001	                }	            }	        ],	        "vout": [	            {	                "amount": 400000,	                "target": {	                    "key": "63c707badaf0151912408d812098c8b8f42a937532f20060b014ccb5a98d9f0500"	                }	            },	            {	                "amount": 6000000,	                "target": {	                    "key": "16eea8ffd98d418e24a78a8ac94020465467b162023a0777d4a76260f9f30b1700"	                }	            },	            {	                "amount": 70000000,	                "target": {	                    "key": "60060bf166f6279ecf11e12ed490120f8890b0e5827bfaf9ccee0fc4a06b8e9600"	                }	            },	            {	                "amount": 900000000,	                "target": {	                    "key": "8fd00058af39451e82ed4e4e5d516878ab49ab178b747c3fd92d94f9041dd9bd00"	                }	            },	            {	                "amount": 7000000000,	                "target": {	                    "key": "8626ce6ec6003e27e675934e81612db577e47c7346b750ae0d4022bc3dfb51a200"	                }	            },	            {	                "amount": 90000000000,	                "target": {	                    "key": "a1dfac9db983dbf5b08da1fd69935d04fc64116735e9956b81cea2684972c94a00"	                }	            },	            {	                "amount": 700000000000,	                "target": {	                    "key": "e8278e157293077d560821affd29eefcaf9f7b40d7ae58a38dde4c8e26c5b95e00"	                }	            },	            {	                "amount": 8000000000000,	                "target": {	                    "key": "5b8097a74b3e72e9fa18a8a2724b68b035e97f4afcb50cfdcf0db4acb8daad3b00"	                }	            },	            {	                "amount": 60000000000000,	                "target": {	                    "key": "61397e6cb9b482341998c680428008b88b3cfd95a3dce0b9884865e23519825a00"	                }	            },	            {	                "amount": 6879797640000,	                "target": {	                    "key": "e1950b810f6c2da80d96e80975ce8990816137dbde08a6f375006d862c6a56ec00"	                }	            },	            {	                "amount": 764421960000,	                "target": {	                    "key": "81af4b7cae885d4ae1199b1002a4ffb9239c67ec64c9df07d453230bd4d0b17e00"	                }	            }	        ],	        "extra": [	            1,	            106,	            220,	            188,	            71,	            105,	            187,	            236,	            197,	            132,	            195,	            67,	            253,	            223,	            5,	            0,	            30,	            174,	            253,	            34,	            45,	            246,	            170,	            235,	            38,	            40,	            111,	            21,	            136,	            15,	            78,	            111,	            9,	            2,	            30,	            48,	            46,	            54,	            46,	            54,	            46,	            49,	            40,	            48,	            46,	            49,	            45,	            103,	            52,	            48,	            98,	            56,	            57,	            102,	            48,	            41,	            0,	            0,	            0,	            6,	            79,	            169,	            114,	            25,	            0	        ],	        "signatures": []	    },	    "tx_hashes": []	}				`txs`是交易列表，格式同2.2.1.3节的交易JSON格式。#####2.2.1.6发送交易sendrawtransaction	RPC命令：http://127.0.0.1:37709/sendrawtransaction输入数据：	{	    "tx_as_hex": "c12a7030eaf7e336e54a2d1b62c9c216cebfb34398d6371d3ea83ec8e1bd91b"	}	输入数据：tx_as_hex是以十六制字符串表示的交易内容。输出结果：	{	    "status": "OK"	}#####2.2.1.7开始挖矿start_mining RPC命令：http://127.0.0.1:37709/start_mining	输入数据：	{	    "miner_address": "D4GyKPd9Qg8eEFYgAeab86Hivr9HrMcSMR4MnQmM7wAmKjz7Fuiu9wbWCb37PGCkLkSSRRmjGG7cuThb8BgLK4beT4bDiMw",	    "thread": "1"	}其中：miner_address：挖矿地址thread：线程数量输出结果：	{	    "status": "OK"	}#####2.2.1.8停止挖矿stop_miningRPC命令：http://127.0.0.1:37709/stop_mining输入数据：无输出结果：	{	    "status": "OK"	}#####2.2.1.9得到统计信息getinfo	RPC命令：http://127.0.0.1:37709/getinfo输入数据：无输出结果：	{	    "alias_count": 16,	    "alt_blocks_count": 0,	    "current_blocks_median": 30000,	    "current_network_hashrate_350": 2262006334,	    "current_network_hashrate_50": 2435368275,	    "daemon_network_state": 2,	    "difficulty": 137300603865,	    "grey_peerlist_size": 82,	    "height": 73137,	    "incoming_connections_count": 28,	    "max_net_seen_height": 0,	    "mi": {	        "build_no": 0,	        "mode": 0,	        "ver_major": 0,	        "ver_minor": 0,	        "ver_revision": 0	    },	    "outgoing_connections_count": 5,	    "scratchpad_size": 31065728,	    "status": "OK",	    "synchronization_start_height": 0,	    "transactions_cnt_per_day": 829,	    "transactions_volume_per_day": 1068648337000000000,	    "tx_count": 46278,	    "tx_pool_size": 3,	    "white_peerlist_size": 35	}###2.2.2 JSON_RPCJSON_RPC接口都是通过`/json_rpc`来实现的接口，主要用于挖矿程序。RPC命令：http://127.0.0.1:37709/json_rpc　输入数据格式如下所示：	{	    "jsonrpc": "2.0",	    "id": "test",	    "method": "getblockcount",	    "params": []	}其中id内容可任意指定，method是下面要说明的每一种方法，params是每种方法所带的参数，如果没有参数，params可为空。输出结果格式为：	{	    "id": "test",	    "jsonrpc": "2.0",	    "result": {	        "count": 73174,	        "status": "OK"	    }	}其中`result`是输出结果，`status`为`OK`，则正确返回,否则出错。可以用`curl -X POST  http://127.0.0.1:37709/json_rpc -d`该命令来测试所有接口，如果在WINDOWS下，则需要把`-d`后的数据中所有`”`替换为`\”`。####2.2.2.1得到区块高度GetblockcountInput:	{	    "jsonrpc": "2.0",	    "id": "test",	    "method": "getblockcount"	}Output:		{	    "id": "test",	    "jsonrpc": "2.0",	    "result": {	        "count": 73174,	        "status": "OK"	    }	}####2.2.2.2获得某高度的区块HASH值on_getblockhashInput:	{	    "jsonrpc": "2.0",	    "id": "test",	    "method": "on_getblockhash",	    "params": {	        "height": 27894	    }	}Output:	{	    "id": "test",	    "jsonrpc": "2.0",	    "result": "5b786d239d218f63e3542b9e983be73828b035e8ffdc4ad19ce30fc71eb9826f"	}####2.2.2.3获得区块模板GetblocktemplateInput:	{	    "jsonrpc": "2.0",	    "id": "test",	    "method": "getblocktemplate",	    "params": {	        "reserve_size": 200,	        "wallet_address": "D4Jyd47oagvJwNrnc2hmRTZdm9SwRd2XiHqVFkGuuf2yNdRtDQAeHJSEGfqx2YYpn6Zut1uSWYrYrhPCRnwvV6gmSnDpAtc"	    }	}Output:		{	    "id": "test",	    "jsonrpc": "2.0",	    "result": {	        "blocktemplate_blob": "010000000000000000467c9a46dd7b40113ef290532f1bfd206867438e753c9a0dc9706167fc6a553000f4dcf5a305000187ba0401ffcbb9040b80b51802010efb9111608d38a35392e44615231289cf2879751ac032a00302f653b9be4300809bee0202411bb46fa770c85e1e496fc1f1650f7228267f4a8091f26b309c68738fab9e6f0080b48913024d222080ecd6ceeb5add88fcbfc6878d2d88bfa440ead5eab5285ddb6ebdd15e0080c2d72f02d1c4f340f01cf1b68283c45aa46e323a9b62e5418bfe2e3c1a9ebc2ac9a521430080d0acf30e027719b614d0bd73229c86e3012aacb07ae3c33743cf467bacf20cceb79ce3c143008090dfc04a028685e17199590a00478258c14a71b0cbdb7818dcd052d84dd7f85ce6dddebaa20080e0a596bb1102f19fb7af89b82b7b0270f3b1a96cc53a16583ff5e44cd4c9b6625d76deffb1540080c0a8ca9a3a02f46886db803b2aaf8172d7639bcb06c56d70110114014cfdfc34154236b6b1d80080c089a9a2f50f025849511c77e484e1c57fb353d95be34abb06e978a1d2aef8908f2ad22664625b0080a794cdaed3010204630aac829b741ee8c2a24d880181ae35493394ba25e7b7f72ead3016743e3b0080afc988be1702ba0bc82180635b994212bd4ae7597fa415928afd4d612eca6d04941094e968d600810201ed81936f2763872638d0a71cef7aee28daa9e27f53e98a925feecd7d186b575502de302e362e362e3128302e312d6734306238396630290000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",	        "difficulty": 133796655084,	        "height": 72907,	        "reserved_offset": 548,	        "status": "OK"	    }	}####2.2.2.4提交区块SubmitblockInput:	{	    "jsonrpc": "2.0",	    "id": "test",	    "method": "submitblock",	    "params": [	        "0100...."	    ]	}	Output:	{	    "id": "test",	    "jsonrpc": "2.0",	    "result": {	        "status": ""	    }	}####2.2.2.5获得最新的区块头GetlastblockheaderInput:	{	  "jsonrpc": "2.0",	  "id" : "test",	  "method": "getlastblockheader"	}Output:	{	  "id": "test",	  "jsonrpc": "2.0",	  "result": {		"block_header": {		  "depth": 0,		  "difficulty": 133724167762,		  "hash": "8259c5a6246d7ef6354725b3e62ad15783d20bdcab02d30b49942569e71b3e7e",		  "height": 72913,		  "major_version": 1,		  "minor_version": 0,		  "nonce": 2153013099,		  "orphan_status": false,		  "prev_hash": "2349ad96994efb52ae6bd56a6f446039636f521f1e1a79105ab92233668574ad",		  "reward": 80752802000000,		  "timestamp": 1417506962		},		"status": "OK"	  }	}####2.2.2.6通过ID获得区块头GetblockheaderbyhashInput:		{	  "jsonrpc": "2.0",	  "id" : "test",	  "method": "getblockheaderbyhash",	  "params": {		"hash" : "8259c5a6246d7ef6354725b3e62ad15783d20bdcab02d30b49942569e71b3e7e "	  }	}Output:	{	  "id": "test",	  "jsonrpc": "2.0",	  "result": {		"block_header": {		  "depth": 5,		  "difficulty": 133724167762,		  "hash": "8259c5a6246d7ef6354725b3e62ad15783d20bdcab02d30b49942569e71b3e7e",		  "height": 72913,		  "major_version": 1,		  "minor_version": 0,		  "nonce": 2153013099,		  "orphan_status": false,		  "prev_hash": "2349ad96994efb52ae6bd56a6f446039636f521f1e1a79105ab92233668574ad",		  "reward": 80752802000000,		  "timestamp": 1417506962		},		"status": "OK"	  }	}	####2.2.2.7通过高度获得区块头GetblockheaderbyheightInput:	{	  "jsonrpc": "2.0",	  "id" : "test",	  "method": "getblockheaderbyheight",	  "params": {		"height" : 72893	  }	}Output:			{	  "id": "test",	  "jsonrpc": "2.0",	  "result": {		"block_header": {		  "depth": 28,		  "difficulty": 132949309870,		  "hash": "a30ba1b3fe7e525d13820133841b3194ec5772fa6715a5da7e2c55614e305828",		  "height": 72893,		  "major_version": 1,		  "minor_version": 0,		  "nonce": 3642722453,		  "orphan_status": false,		  "prev_hash": "1f439c5e2ae6164e498e6cf09d3f957de693729153af2c65de318063889d1329",		  "reward": 80702116000000,		  "timestamp": 1417505776		},		"status": "OK"	  }	}####2.2.2.8获取所有别名数据get\_all\_alias_details输入数据	{	"id": 0,	"jsonrpc":"2.0",	"method":"get_all_alias_details"，	"params":{}	}输出数据：	{	  "id": 0,	  "jsonrpc": "2.0",	  "result": {	    "aliases": [{	      "address": "DBFvyhGzEo6FqheGUMVaBM56crUeRvPQzVrDXLMJytGH481WsL5PSmXJq2evy1BsPF9zyg9VsNr2BhdgTCQ7Q8mqQsmjxG9",	      "alias": "darknetspace",	      "comment": "darknetspace",	      "tracking_key": ""	    },{	      "address": "DBFvyhGzEo6FqheGUMVaBM56crUeRvPQzVrDXLMJytGH481WsL5PSmXJq2evy1BsPF9zyg9VsNr2BhdgTCQ7Q8mqQsmjxG9",	      "alias": "darknetcoin",	      "comment": "darknetcoin",	      "tracking_key": ""	    }	],	    "status": "OK"	  }	}####2.2.2.9 获取指定别名数据get\_alias\_details 输入数据：	{	"id": 0,	"jsonrpc":"2.0",	"method":"get_alias_details"，	"params":｛"alias": "darknetspace"｝	}输出数据:		{	  "id": 0,	  "jsonrpc": "2.0",	  "result": {	    "alias_details": {	      "address": "DBFvyhGzEo6FqheGUMVaBM56crUeRvPQzVrDXLMJytGH481WsL5PSmXJq2evy1BsPF9zyg9VsNr2BhdgTCQ7Q8mqQsmjxG9",	      "comment": "darknetspace",	      "tracking_key": ""	    },	    "status": "OK"	  }	}###2.2.2.10 通过地址获取账号get\_alias\_by_address 输入数据：	{	"id": 0,	"jsonrpc":"2.0",	"method":"get_alias_by_address"，	"params":"DBFvyhGzEo6FqheGUMVaBM56crUeRvPQzVrDXLMJytGH481WsL5PSmXJq2evy1BsPF9zyg9VsNr2BhdgTCQ7Q8mqQsmjxG9"	}输出数据：	{	  "id": 0,	  "jsonrpc": "2.0",	  "result": {	    "alias": "darknetspace",	    "status": "OK"	  }	}###2.2.2.11获取附件 get_addendums 输入数据：	{	"id": 0,	"jsonrpc":"2.0",	"method":"get_addendums"，	"params":{}	}输出数据：	{	  "id": 0,	  "jsonrpc": "2.0",	  "result": {	    "status": "OK"	  }	}###2.2.3 BIN接口这是RPC的BIN接口，即其中的输入和输出参数全部是二进制数据，这些BIN接口命令以.bin为结尾，主要用于C/C++程序的实时和高效接口。输入数据全部以数据结构`storage_block_header`为初始数据：	struct storage_block_header	{		   uint32_t m_signature_a;	uint32_t m_signature_b;	uint8_t  m_ver;	};并且在本暗网空间版本下，其中的数据是一定值：	#define PORTABLE_STORAGE_SIGNATUREA 0x01011101	#define PORTABLE_STORAGE_SIGNATUREB 0x01020101 // bender's nightmare 	#define PORTABLE_STORAGE_FORMAT_VER 1	m_signature_a = PORTABLE_STORAGE_SIGNATUREA;	m_signature_b = PORTABLE_STORAGE_SIGNATUREB;	m_ver = PORTABLE_STORAGE_FORMAT_VER;####2.2.3.1 获得某个交易的所有输出get\_o\_indexes.binRPC命令：http://127.0.0.1:37709/get\_o\_indexes.bin输入数据：某交易的HASH值	  crypto::hash txid;输出结果：	  std::vector<uint64_t> o_indexes;	  std::string status;其中`o_indexes`是该交易的输出列表索引列表。数据结构定义如下：		struct COMMAND_RPC_GET_TX_GLOBAL_OUTPUTS_INDEXES	  {		struct request		{		  crypto::hash txid;		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE_VAL_POD_AS_BLOB(txid)		  END_KV_SERIALIZE_MAP()		};		struct response		{		  std::vector<uint64_t> o_indexes;		  std::string status;		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(o_indexes)			KV_SERIALIZE(status)		  END_KV_SERIALIZE_MAP()		};	  };	  ####2.2.3.2 获得当前内存池交易列表get\_tx\_pool.bin本命令与JSON的`get_tx_pool`一样，所不同的是BIN接口。RPC命令：http://127.0.0.1:37709/get_tx_pool.bin输入数据：无输出结果：	  std::list<blobdata> txs;  //transactions blobs	  std::string status;`txs`是以十六进制输出的交易列表。数据结构定义如下：	struct COMMAND_RPC_GET_TX_POOL	  {		struct request		{		  BEGIN_KV_SERIALIZE_MAP()		  END_KV_SERIALIZE_MAP()		};		struct response		{			  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(txs)			KV_SERIALIZE(status)		  END_KV_SERIALIZE_MAP()		};	  };####2.2.3.3 获得区块列表getblocks.bin本功能与JSON的`get_blocks_by_heights`类似，但为bin接口。RPC命令：http://127.0.0.1:37709/getblocks.bin输入数据：	std::list<crypto::hash> block_ids; 其中：前10个ID要求是顺序的，后面跟随pow(2,n) 的ID，就像2, 4, 8, 16, 32, 64之类的。最后一个ID要求是创世块ID。这样的要求是为了验证请求端区块链的正确性。输出结果：	std::list<block_complete_entry> blocks;	uint64_t	start_height;	uint64_t	current_height;	std::string status;其中：`start_height`是起始高度`current_height`是当前高度`blocks`是区块数据，包含块头和交易。数据结构的定义如下所示：	  struct COMMAND_RPC_GET_BLOCKS_FAST	  {		struct request		{	std::list<crypto::hash> block_ids; 		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE_CONTAINER_POD_AS_BLOB(block_ids)		  END_KV_SERIALIZE_MAP()		};		struct response		{		  std::list<block_complete_entry> blocks;		  uint64_t	start_height;		  uint64_t	current_height;		  std::string status;		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(blocks)			KV_SERIALIZE(start_height)			KV_SERIALIZE(current_height)			KV_SERIALIZE(status)		  END_KV_SERIALIZE_MAP()		};	  };	  ####2.2.3.4 获得某金额的随机输出列表getrandom\_outs.binRPC命令：http://127.0.0.1:37709/getrandom_outs.bin输入数据：	  std::list<uint64_t> amounts;	  uint64_t			outs_count;	  bool				use_forced_mix_outs;其中：`amounts`为金额列表，`outs_count`为要求的输出个数，`use_forced_mix_outs`是否强制要求混币次数。输出结果：	  std::vector<outs_for_amount> outs;	  std::string status;其中：`outs`是输出的列表。数据结构定义如下：	struct COMMAND_RPC_GET_RANDOM_OUTPUTS_FOR_AMOUNTS	  {		struct request		{		  std::list<uint64_t> amounts;		  uint64_t			outs_count;		  bool				use_forced_mix_outs;		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(amounts)			KV_SERIALIZE(outs_count)			KV_SERIALIZE(use_forced_mix_outs)		  END_KV_SERIALIZE_MAP()		};		#pragma pack (push, 1)		struct out_entry		{		  uint64_t global_amount_index;		  crypto::public_key out_key;		};	#pragma pack(pop)			struct outs_for_amount		{		  uint64_t amount;		  std::list<out_entry> outs;			  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(amount)			KV_SERIALIZE_CONTAINER_POD_AS_BLOB(outs)		  END_KV_SERIALIZE_MAP()		};		struct response		{		  std::vector<outs_for_amount> outs;		  std::string status;		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(outs)			KV_SERIALIZE(status)		  END_KV_SERIALIZE_MAP()		};	  };####2.2.3.5 设置开发者信息set\_maintainers\_info.bin本功能是给暗网空间研发团队使用的，广播一些重要通知。RPC命令：http://127.0.0.1:37709/set\_maintainers\_info.bin 输入数据：	nodetool::maintainers_entry输出结果：	std::string status;数据结构如下：		struct COMMAND_RPC_SET_MAINTAINERS_INFO	  {		typedef nodetool::maintainers_entry request;		struct response		{		  std::string status;		  BEGIN_KV_SERIALIZE_MAP()			KV_SERIALIZE(status)		  END_KV_SERIALIZE_MAP()		};	  };`nodetool::maintainers_entry`数据结构定义如下：	struct alert_condition	  {		uint32_t if_build_less_then; //apply alert if build less then		uint8_t  alert_mode;			BEGIN_KV_SERIALIZE_MAP()		  KV_SERIALIZE_N(if_build_less_then, "build")		  KV_SERIALIZE_N(alert_mode, "mode")		END_KV_SERIALIZE_MAP()		  };	  struct maintainers_info	  {		uint64_t timestamp;		/*actual version*/		uint8_t  ver_major;		uint8_t  ver_minor;		uint8_t  ver_revision;		uint32_t build_no;		/*conditions for alerting*/		std::list<alert_condition> conditions;			BEGIN_KV_SERIALIZE_MAP()		  KV_SERIALIZE_N(timestamp, "ts")		  KV_SERIALIZE_N(ver_major, "maj")		  KV_SERIALIZE_N(ver_minor, "min")		  KV_SERIALIZE_N(ver_revision, "rev")		  KV_SERIALIZE_N(build_no, "build")		  KV_SERIALIZE_N(conditions, "cs")		END_KV_SERIALIZE_MAP()	  };	  struct maintainers_entry	  {		blobdata maintainers_info_buff;		crypto::signature sign;		BEGIN_KV_SERIALIZE_MAP()		  KV_SERIALIZE(maintainers_info_buff)		  KV_SERIALIZE_VAL_POD_AS_BLOB(sign)		END_KV_SERIALIZE_MAP()	  };##3. 钱包simplewallet使用及开发指南`simplewallet`是CN系列币的钱包程序，在运行`simplewallet`之前，首先要运行`dnsd`并且完成网络同步，才能正常使用`simplewallet`。`simplewallet`有两种运行方式，`命令行方式`和`RPC方式`。###3.1命令行方式命令行运行方式是指可以用命令行进行互动操作的运行方式，以下是运行例子。Linux下创建一个名为test.dnc的钱包，其中test.dnc和123456都可以改变。	./simplewallet --generate-new-wallet test.dnc - password 123456Linux下打开已有账号：	./simplewallet --wallet-file test.dnc --password 123456输入`help`可看到所有支持的命令。这些命令有：|命令|命令说明||--|--||address|显示钱包地址||balance|显示钱包币数||bc_height|显示区块高度||help|显示帮助信息||incoming_transfers|显示收入的交易（全部或者设置参数过滤部分）||list_recent_transfers|显示最新的交易（最大100次）||payments|显示出所有||refresh|刷新钱包的交易和币数||save|保存钱包数据||set_log|更改日志等级（0-4）||start_mining|开始挖矿||stop_mining|结束挖矿||transfer|交易mixin_count是混币次数，Amount是金额 Transfer  <mixin_count>  <addr_1> <amount_1> [<addr_2>  <amount_2> ... <addr_N>  <amount_N>] [payment_id]|###3.2 RPC运行方式`RPC运行方式`无法执行输入命令，可以通过RPC命令进行操作,适合交易所、矿池。Linux下进入RPC运行方式，其中`37710`端口可以随意指定。	./simplewallet --wallet-file test.dnc --password 123456 –rpc-bind-port 37710RPC接口标准：http://localhost:37710/json_rpc，并且采用JSON数据交互。####3.2.1 得到帐户金额getbalance`getbalance`命令是得到帐户金额，包括总金额和可用金额。`balance`是总金额，`unlocked_balance`是可用金额，数值是真正的金额的十亿倍。输入数据：	{		"jsonrpc": "2.0", 		"method": "getbalance", 		"params": {}	}输出结果：	{	  "id": 0,		 "jsonrpc": "2.0",	  "result": {		"balance": 29540782235038289,		"unlocked_balance": 28814612946038289    }	总金额=balance*10^-10=2954078.2235038289	可用余额=unlocked_balanc *10^-10=288146.12946038289####3.2.2 发送币transfer`transfer`是指向某个帐户发送币。其中`payment_id`是可选项，如果填写，则必须是一个32位的HASH值。 `amount`是币的数量=1111110\*10<sup>-10</sup> =0.0000011111个币。`fee`是交易手续费=1000000000\*10<sup>-10</sup>=0.1个币。`mixin`是混币次数，0就是不混币直接发，填n就是发送已经混n次的币，`unlock_time`是锁定时间，可以让别人在这个锁定时间后才使用这些币。输入数据：	{	    "jsonrpc": "2.0",	    "method": "transfer",	    "params": {	        "destinations": [	            {	                "amount": 11111,	                "address": "D4Jyd47oagvJwNrnc2hmRTZdm9SwRd2XiHqVFkGuuf2yNdRtDQAeHJSEGfqx2YYpn6Zut1uSWYrYrhPCRnwvV6gmSnDpAtc"	            }	        ],	        "payment_id": "",	        "fee": 1000000000,	        "mixin": 0,	        "unlock_time": 0	    }	}输出结果：	{	    "id": 0,	    "jsonrpc": "2.0",	    "result": {	        "tx_hash": "<19907e8e2354718a80bd7315bdf78228662cde226e39e3c19012208132209601>"	    }	}错误的输出（地址输入错误）：	{	    "error": {	        "code": -2,	        "message": "WALLET_RPC_ERROR_CODE_WRONG_ADDRESS: D4Jyd47oagvJwNrnc2hmRTZdm9SwRd2XiHqVFkGuuf2yNdRtDQAeHJSEGfqx2YYpn6Zut1uSWYrYrhPCRnwvV6gmSnDpAt"	    },	    "id": 0,	    "jsonrpc": "2.0"	}错误的输出（fee错误）	{	    "error": {	        "code": -4,	        "message": "transaction was rejected by daemon"	    },	    "id": 0,	    "jsonrpc": "2.0"	}####3.2.3 存储Store存储钱包同步数据到本地。	输入数据：	{	    "jsonrpc": "2.0",	    "method": "store",	    "params": {}	}####3.2.4获取支付数据get_payments获取指定`payment_id`的交易`get_payments`输入数据：	{	    "jsonrpc": "2.0",	    "method": "get_payments",	    "params": {	        "payment_id": "739de437a01cb18fdfa2af63e9fbb9eae7873bebf159a0187a37f0e645b537ea"	    }	}输出结果：	{	    "id": 0,	    "jsonrpc": "2.0",	    "result": {	        "payments": [	            {	                "amount": 100000000000,	                "block_height": 85711,	                "tx_hash": "52778f573a7d969c72b0959b67703605b63aadc14e7da9689529dff3e6431656",	                "unlock_time": 0	            }	        ]	    }	}返回了该交易ID、交易金额、区块数和锁定时间。####3.2.5获取钱包地址getaddress获取本钱包地址getaddress。输入数据：	{	    "jsonrpc": "2.0",	    "method": "getaddress",	    "params": {}	}输出结果：	{	    "id": 0,	    "jsonrpc": "2.0",	    "result": 		{	        "address":"D4Jyd47oagvJwNrnc2hmRTZdm9SwRd2XiHqVFkGuuf2yNdRtDQAeHJSEGfqx2YYpn6Zut1uSWYrYrhPCRnwvV6gmSnDpAt"	    }	}####3.2.6获取钱包最新交易get\_incoming_tx**该接口从0.6.8.3版本开始。**获得该钱包指定交易索引号开始，指定数量的交易列表，注意：获得的交易信息至少已经获得了一个确认，未确认的交易不能通过该接口获得。输入数据：	{	    "jsonrpc": "2.0",	    "method": "get_incoming_tx",	    "params": {	        "tx_start_index": 0,			"tx_get_count":100	    }	}其中"tx\_start\_index"是指开始的交易索引号，该序列号按照交易时间顺序排列，从0开始。tx\_get\_count是指获得多少个交易。以上输入数据表示：获取从0开始的100个交易。tx\_get\_count可以简单地置为0，则该接口将返回所有从交易索引号开始的交易列表。如果钱包的交易太多，比如有1万个交易，可以分页获取，如先获得0－999个交易，再获得1000到1999个交易，依次类推，直到获取完毕。也可以纪录上次的开始交易索引号，以及每次获取的交易数量，定时获取。输出结果：	{	    "id": 0,	    "jsonrpc": "2.0",	    "result": {			"tx_get_count":100	        "incoming_txs": [	            {	                "amount": 100000000000,	                "block_height": 85711,	                "tx_hash": "52778f573a7d969c72b0959b67703605b63aadc14e7da9689529dff3e6431656",	                "unlock_time": 0,					"timestamp":0,						"payment_id": 			"739de437a01cb18fdfa2af63e9fbb9eae7873bebf159a0187a37f0e645b537ea"	            },	            {	                "amount": 100000000000,	                "block_height": 85712,	                "tx_hash": "19907e8e2354718a80bd7315bdf78228662cde226e39e3c19012208132209601",	                "unlock_time": 0,					"timestamp":0,						"payment_id": ""	            }	        ]	    }	}tx\_get\_count是指该钱包总共的交易数量，incoming\_txs是交易信息数组，按照交易产生时间排序。错误的输出（tx\_start\_index超出交易总数时出现的错误）	{	    "error": {	        "code": -4,	        "message": "Transaction start index should be within 0 to 50"	    },	    "id": 0,	    "jsonrpc": "2.0"	}##4.实际应用场景	###4.1 节点节点只需运行`dnsd`程序即可，会自动与网络同步。1．Ubuntu系统	wegt http://www.darknetspace.org/files/DarkNetSpace_Ubunbu64.zip	unzip DarkNetSpace_Ubunbu64.zip	cd DarkNetSpace_Ubunbu64	screen –S dnsd	./dnsd2．Windows系统	http://www.darknetspace.org/download/下载对应版本(32bit,64bit)	解压然后双击运行dnsd.exe	###4.2 交易所钱包策略：仅一个钱包地址，用户的暗网币充值到该钱包地址，用`payment ID`来区分用户，`payment ID`是一串32位的HASH串，由网站生成给用户。用户充值时在钱包程序中输入此`payment ID`，网站可通过`get_payments`的RPC调用来获得指定的`payment ID`的交易。（1）运行`dnsd`，与网络同步最好在运行`dnsd`之前，用`screen –S dnsd`命令新开一个窗口，再运行`dnsd`。  同步完成后，按`CTRL+A+D`，断开与此窗口的连接，但是`dnsd`还是在运行中。（2）生成和同步钱包Linux下创建一个名为test.dnc的钱包，其中test.dnc和123456都可以改变。	./simplewallet --generate-new-wallet test.dnc - password 123456`simplewallet`会与`dnsd`同步钱包，同步完成后，`save`命令保存同步结果，`exit`命令退出。生成的钱包有三个文件：`.address.txt`文件保存钱包地址，可删除；`.dnc`文件是钱包同步数据，如果删除，则要重新与`dnsd`同步钱包数据，比较费时间；`.keys`是最关键的私钥文件，一定要备份好。（3）以`RPC方式`运行`simplewallet`	用`screen –S wallet`命令新开一个窗口，再运行`simplewallet`	./simplewallet --wallet-file test.dnc --password 123456 --rpc-bind-port 37710按`CTRL+A+D`，断开与此窗口的连接，但是`simplewallet`还是在运行中。在RPC模式下，`simplewallet`会自动更新区块，但不会保存同步信息。因而要定时保存钱包同步信息，即使钱包重启也不会耽误太多时间。定时保存见RPC的`store`命令。 (4) RPC调用RPC接口标准：http://localhost:37710/json_rpc，并且采用JSON数据交互。RPC接口见3.2###4.3 矿池矿池配置：2CPU/4G内存/20G硬盘空间以上，最好4CPU/8G内存/50G内存。以下是建立矿池的指令。安装没有顺序，运行有顺序1. 节点安装数据库 redis		wget http://redis.googlecode.com/files/redis-2.6.13.tar.gz 		tar xzf redis-2.6.13.tar.gz 		cd redis-2.6.13 		make 		make install 	2. 安装网页服务器 httpd		apt-get install lighttpd		修改/etc/lighttpd/ lighttpd.conf中的网页根目录为/var/www3. 安装node：		sudo apt-get install git-core build-essential curl libcurl4-openssl-dev		下载代码到 ~目录下（root目录），		git clone  https://github.com/joyent/node.git		进入node目录		cd node && ./configure && make		make install4. 安装 pool： 		从http://github.com/cryptocoinlabs/node-cryptonote-pool下载代码		解压拷贝到pool目录下，把pool目录下的example_webiste目录的文件全部拷贝到/var/www下。		去dnsd目录  用simplewallet生成一个钱包地址		去pool目录，vi config.json 修改IP地址和钱包地址。5. 安装 dnsd：略6. 运行：	1. 运行dnsd，进入dnsd目录下				screen –S dnsd			./dnsd			Ctrl + A + D		2. 运行redis					screen –S redis			./redis-server			Ctrl + A + D		3. 运行钱包，进入dnsd目录				screen –S wallet 			./simplewallet --generate-new-wallet pool.bin --password 12345678 			./simplewallet --wallet-file pool.bin --password 12345678 --rpc-bind-port 37710  			Ctrl + A + D	  	4. 运行pool，进入pool目录				screen –S pool			node init.js			Ctrl + A + D	5. 用浏览器访问矿池IP，如果出现以下图片说明正常：	 	![](http://darknetspace.org/files/manual06.png)								  如果只出现文字，未出现具体数据，则有可能pool没有正常运行。